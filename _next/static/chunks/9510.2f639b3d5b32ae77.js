"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9510],{8545:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(3946),o=n(1820),i=n(3882);function u(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,o.Z)(e,6e4*n)}},7566:function(e,t,n){var r=n(2809),o=n(917),i=n(1164),u=n(6914),c=n(6557),a=n(5944),l=["show","children"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.show,n=e.children,r=(0,i.Z)(e,l);return(0,a.tZ)("div",d(d({css:(0,o.iv)({position:"fixed",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:u.t,zIndex:c.k.FIXED_BOTTOM,boxSizing:"border-box"},"","")},r),{},{children:(0,a.tZ)("div",{css:(0,o.iv)({transform:"translateY(".concat(t?"0":"100%",")"),transition:"transform 0.3s ease-in-out"},"",""),children:n})}))}},4143:function(e,t,n){n.d(t,{P:function(){return r},Y:function(){return o}});var r=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],o={SUNDAY:"\uc77c\uc694\uc77c",MONDAY:"\uc6d4\uc694\uc77c",TUESDAY:"\ud654\uc694\uc77c",WEDNESDAY:"\uc218\uc694\uc77c",THURSDAY:"\ubaa9\uc694\uc77c",FRIDAY:"\uae08\uc694\uc77c",SATURDAY:"\ud1a0\uc694\uc77c"}},9510:function(e,t,n){n.r(t),n.d(t,{default:function(){return W}});var r=n(2809),o=n(7566),i=n(8031),u=n(266),c=n(9711),a=n(809),l=n.n(a),s=n(5641),d=n(7294),f=n(8424),v=n.n(f);var h=n(767),m=n(9929),p=n(9230),b=n(5458),y=function(e){var t;return function(){return t||(t=v().createClient(e)),t}}({mode:"rtc",codec:"vp8"}),O=function(e){var t=null;return function(){var n=(0,d.useState)(!1),r=n[0],o=n[1],i=(0,d.useState)(null),u=i[0],c=i[1],a=(0,d.useRef)(t);return(0,d.useEffect)((function(){return null===a.current?function(){try{return Promise.resolve(v().createMicrophoneAudioTrack(e)).then((function(e){return t=e}))}catch(n){return Promise.reject(n)}}().then((function(e){a.current=e,o(!0)}),(function(e){c(e)})):o(!0),function(){t=null}}),[]),{ready:r,track:a.current,error:u}}}({encoderConfig:"high_quality"});var g=n(9353),w=n(917),k=n(9445),Z=n(1371),T=n(5944),D=function(e){var t=e.defaultValue,n=e.onChange,r=(0,d.useState)(null!==t&&void 0!==t&&t),o=r[0],i=r[1],u=o?"mic-off":"mic";return(0,d.useEffect)((function(){null===n||void 0===n||n(o)}),[o]),(0,T.tZ)("button",{css:(0,w.iv)({backgroundColor:o?Z.O.gray[4]:Z.O.gray[2],borderRadius:"50%",border:"none",width:50,height:50,cursor:"pointer",transition:"background-color 0.2s ease-in-out"},"",""),onClick:function(){return i((function(e){return!e}))},children:(0,T.tZ)(k.J,{name:u,type:"outline",size:30,color:Z.O.white},u)})},j=n(1164);var S=["userName","color","size","fontSize","children","audioTrack"];function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){var t=e.userName,n=e.color,r=e.size,o=(e.fontSize,e.children),i=e.audioTrack,u=(0,j.Z)(e,S),c=(0,d.useState)(0),a=c[0],l=c[1],s=.3*a+1;return(0,d.useEffect)((function(){if(null!=i)return i.setAudioFrameCallback((function(e){var t=e.getChannelData(0);l(2*function(e){var t=e.reduce((function(e,t){return e+Math.abs(t)}),0);return Math.sqrt(t/e.length)}(t))})),function(){try{null===i||void 0===i||i.setAudioFrameCallback(null)}catch(e){e instanceof Error&&console.warn(e.message)}}}),[i]),(0,T.BX)(g.Kq,{gutter:16,direction:"column",align:"center",children:[(0,T.tZ)(g.kC,E(E({direction:"column",justify:"center",align:"center",css:(0,w.iv)({backgroundColor:n,color:Z.O.white,width:r,height:r,borderRadius:"50%",opacity:.6,transition:"background-color 0.5s ease-in"},"","")},u),{},{children:(0,T.tZ)("div",{style:{transform:"scale(".concat(s,")")},css:(0,w.iv)({width:r,height:r,transition:"transform 0.1s ease-in-out",filter:"blur(2px)",position:"absolute",zIndex:0,backgroundColor:n,opacity:.3,borderRadius:"50%"},"","")})})),(0,T.tZ)(g.H_,{size:14,weight:"bold",align:"center",css:(0,w.iv)({width:r+24,wordBreak:"break-all"},"",""),children:t}),o]})};var P={name:"1d3w5wq",styles:"width:100%"},z=function(e){var t=e.playing,n=e.me,r=e.myAudioTrack,o=e.remoteUser,i=e.remoteUserAudioTrack,u="JOINED"===e.remoteStatus,c=u&&null==i;return(0,T.BX)(g.Kq,{justify:"center",gutter:32,css:P,children:[(0,T.tZ)(A,{userName:n.nickname,color:t?Z.O.primary:Z.O.gray[3],size:100,audioTrack:r}),(0,T.tZ)(A,{userName:o.nickname,color:u?Z.O.cyan[5]:Z.O.gray[3],size:100,audioTrack:i,children:c&&(0,T.BX)(T.HY,{children:[(0,T.tZ)(g.Ki,{size:8}),(0,T.tZ)(k.J,{name:"mic-off",size:20,color:Z.O.red[5]})]})})]})},N=n(8996),_=n(9184),R=n(9013),U=n(3882);var Y=n(3946),I=n(8545);var x=function(e){return function(e,t){(0,U.Z)(2,arguments);var n=(0,Y.Z)(t);return(0,I.Z)(e,-n)}(e,10)};function B(e){var t=(0,b.z)(e).data,n=(0,d.useState)(!1),r=n[0],o=n[1];return(0,s.Yz)((function(){if(null!=t){var e=function(e,t){(0,U.Z)(2,arguments);var n=(0,R.Z)(e),r=(0,R.Z)(t);return n.getTime()>r.getTime()}(new Date,x(new Date(t.start_datetime)));o(e&&"DONE"!==t.status)}}),1e3),r}var M=n(90);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q={name:"a3z6ut",styles:"padding:0 20px"},F={name:"1d3w5wq",styles:"width:100%"},J={name:"1d3w5wq",styles:"width:100%"},K=function(e,t){var n;switch(t){case"WAITING":return"\uc778\ud130\ubdf0\uac00 \uc544\uc9c1 \uc2dc\uc791\ub418\uc9c0 \uc54a\uc558\uc5b4\uc694";case"DONE":return"\uc778\ud130\ubdf0\uac00 \uc885\ub8cc\ub418\uc5c8\uc5b4\uc694";default:return"".concat(null!==(n=null===e||void 0===e?void 0:e.nickname)&&void 0!==n?n:"OOO","\ub2d8\uacfc\uc758 \uc778\ud130\ubdf0")}},W=function(e){var t,n=e.interviewId,r=e.token,a=e.onReady,f=e.onEnd,v=e.onRemoteUserJoined,w=e.onRemoteUserLeaved,k=(0,m.E)().me,j=(0,b.z)(n).data,S=B(n),C=function(e){var t=(0,b.z)(e).data,n=(0,d.useState)(0),r=n[0],o=n[1];return(0,s.Yz)((function(){if(null!=t){var e=new Date,n=new Date(t.end_datetime);o((n.getTime()-e.getTime())/1e3)}}),500),Math.floor(r)}(n),E=(null===j||void 0===j?void 0:j.interviewer.id)===(null===k||void 0===k?void 0:k.id)?null===j||void 0===j?void 0:j.interviewee:null===j||void 0===j?void 0:j.interviewer,A=function(e){var t=e.interviewId,n=e.channelName,r=e.token,o=e.onRemoteUserJoined,i=e.onRemoteUserLeaved,a=y(),f=O(),v=f.track,g=f.ready,w=(0,s.zj)(),k=(0,c.Z)(w,3),Z=k[0],T=k[1],D=k[2],j=(0,d.useState)("WAITING"),S=j[0],C=j[1],E=(0,d.useState)(),A=E[0],P=E[1],z=(0,m.E)().me,N=(0,b.z)(t).data,_=(0,d.useMemo)((function(){return(null===N||void 0===N?void 0:N.interviewer.id)===(null===z||void 0===z?void 0:z.id)?null===N||void 0===N?void 0:N.interviewee:null===N||void 0===N?void 0:N.interviewer}),[N,z]),R=(0,d.useCallback)((0,u.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,p.hT)(t),e.next=3,a.join(h.xD,n,r,z.id);case 3:T(),null!=v&&a.publish(v);case 5:case"end":return e.stop()}}),e)}))),[v,T]),U=(0,d.useCallback)((0,u.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C("LEFT"),P(void 0),a.leave(),null===v||void 0===v||v.setMuted(!1),D();case 5:case"end":return e.stop()}}),e)}))),[a,D,v]);return(0,d.useEffect)((function(){if(!1!==g&&null!=v){var e=function(){var e=(0,u.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("\uc720\uc800\uac00 \ucc44\ub110\uc5d0 \uc785\uc7a5\ud558\uc600\uc2b5\ub2c8\ub2e4",t),C("JOINED"),null===o||void 0===o||o();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=(0,u.Z)(l().mark((function e(t,n){var r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799\uc744 Publish \ud558\uc600\uc2b5\ub2c8\ub2e4",t),e.next=3,a.subscribe(t,n);case 3:null===(r=t.audioTrack)||void 0===r||r.setVolume(250),null===(o=t.audioTrack)||void 0===o||o.play(),P(t.audioTrack);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n=function(){var e=(0,u.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799 Publish\ub97c \uc911\ub2e8\ud558\uc600\uc2b5\ub2c8\ub2e4",t),null===(n=t.audioTrack)||void 0===n||n.stop(),e.next=4,a.unsubscribe(t);case 4:P(t.audioTrack);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=function(e){console.log("\uc0c1\ub300\ubc29\uc774 \ud1b5\ud654\ub97c \uc885\ub8cc\ud558\uc600\uc2b5\ub2c8\ub2e4",e),null===i||void 0===i||i()};return a.on("user-joined",e),a.on("user-published",t),a.on("user-unpublished",n),a.on("user-left",r),function(){"CONNECTED"!==a.connectionState&&"CONNECTING"!==a.connectionState||(a.off("user-joined",e),a.off("user-published",t),a.off("user-unpublished",n),a.off("user-left",r))}}}),[g,v,o,i]),{client:a,ready:g,localAudioTrack:v,isCalling:Z,joinToChannel:R,leaveToChannel:U,remoteUser:_,remoteStatus:S,remoteAudioTrack:A}}({interviewId:n,channelName:null!==(t=null===j||void 0===j?void 0:j.agora_channel_id)&&void 0!==t?t:"",token:r,onRemoteUserJoined:v,onRemoteUserLeaved:w}),P=A.client,R=A.ready,U=A.localAudioTrack,Y=A.isCalling,I=A.joinToChannel,x=A.leaveToChannel,H=A.remoteUser,W=A.remoteAudioTrack,G=A.remoteStatus;(0,s.Yz)((function(){null!=k&&null!=j&&function(e){var t=e.userId,n=e.interviewId,r=e.Duration,o=e.OutgoingAvailableBandwidth,i=e.RTT,u=e.RecvBitrate,c=e.RecvBytes,a=e.SendBitrate,l=e.SendBytes,s=e.UserCount;M.G.post("/agora/metrics",{user_id:t,interview_id:n,duration:r,outgoing_available_bandwidth:o,rtt:i,recv_bitrate:u,recv_bytes:c,send_bitrate:a,send_bytes:l,user_count:s})}(X(X({},P.getRTCStats()),{},{userId:k.id,interviewId:j.id}))}),1e3);var L=!0===Y;return(0,d.useEffect)((function(){!0===R&&(null===a||void 0===a||a())}),[R,a]),(0,d.useEffect)((function(){C<0&&!0===Y&&(x(),null===f||void 0===f||f())}),[C,Y,f]),null==k||null==H||null==j?null:(0,T.BX)(g.kC,{direction:"column",css:q,children:[(0,T.BX)(g.Kq,{gutter:16,direction:"column",align:"center",css:F,children:[(0,T.tZ)(g.Ki,{size:18}),(0,T.tZ)(g.H_,{size:20,weight:"bold",align:"center",children:K(E,j.status)}),L?(0,T.BX)(g.H_,{children:["\ub0a8\uc740 \uc2dc\uac04: ",(0,_.mr)(Math.floor(C/60)),":",(0,_.mr)(Math.floor(C%60))]}):(0,T.BX)(g.H_,{color:Z.O.gray[5],size:14,children:["\uc778\ud130\ubdf0 \uc2dc\uac04 : ",(0,N.Z)(new Date(j.start_datetime),"M\uc6d4 d\uc77c HH\uc2dc mm\ubd84")," ~"," ",(0,N.Z)(new Date(j.end_datetime),"M\uc6d4 d\uc77c HH\uc2dc mm\ubd84")]})]}),(0,T.tZ)(g.Ki,{size:40}),(0,T.tZ)(z,{playing:Y,me:k,myAudioTrack:null!==U&&void 0!==U?U:void 0,remoteUser:H,remoteUserAudioTrack:W,remoteStatus:G}),Y?(0,T.BX)(g.kC,{direction:"column",align:"center",justify:"center",css:J,children:[(0,T.tZ)(g.Ki,{size:50}),(0,T.tZ)(D,{defaultValue:null===U||void 0===U?void 0:U.muted,onChange:function(e){null===U||void 0===U||U.setMuted(e)}})]}):null,S&&(0,T.tZ)(o.Z,{show:!0,children:Y?(0,T.tZ)(i.Z.BottomCTA,{onClick:x,children:"\ub098\uac00\uae30"}):(0,T.tZ)(i.Z.BottomCTA,{styleType:"primary",onClick:I,disabled:!1===R||null==U,children:"\uc785\uc7a5\ud558\uae30"})})]})}},9184:function(e,t,n){n.d(t,{x5:function(){return i},FO:function(){return u},mr:function(){return c}});var r=n(8996),o=n(4143),i=function(e){return(0,r.Z)(e,"yyyy-MM-dd'T'HH:mm")},u=function(e){return o.P[e.getDay()]},c=function(e){return e<0?"00":e>9?"".concat(e):"0".concat(e)}}}]);