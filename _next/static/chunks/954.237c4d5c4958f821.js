"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{7951:function(e,n,r){var t=r(2809),o=r(917),i=r(1164),c=r(1371),u=r(9353),a=r(5944),l=["children"],s=["children"];function d(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function f(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?d(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var p=function(e){var n=e.upper,r=e.lower;return(0,a.BX)(u.kC,{direction:"column",children:[(0,a.tZ)(u.Ki,{size:24}),n,null!=n&&null!=r?(0,a.tZ)(u.Ki,{size:8}):null,r,(0,a.tZ)(u.Ki,{size:16})]})};p.Text2=function(e){var n=e.children,r=(0,i.Z)(e,l);return(0,a.tZ)("h2",f(f({css:(0,o.iv)({fontWeight:"bold",fontSize:24,lineHeight:1.3,color:c.O.gray[9],whiteSpace:"pre-line"},"","")},r),{},{children:n}))},p.Text6=function(e){var n=e.children,r=(0,i.Z)(e,s);return(0,a.tZ)("p",f(f({},r),{},{children:n}))},n.Z=p},7566:function(e,n,r){var t=r(2809),o=r(917),i=r(1164),c=r(6914),u=r(6557),a=r(5944),l=["show","children"];function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}n.Z=function(e){var n=e.show,r=e.children,t=(0,i.Z)(e,l);return(0,a.tZ)("div",d(d({css:(0,o.iv)({position:"fixed",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:c.t,zIndex:u.k.FIXED_BOTTOM,boxSizing:"border-box"},"","")},t),{},{children:(0,a.tZ)("div",{css:(0,o.iv)({transform:"translateY(".concat(n?"0":"100%",")"),transition:"transform 0.3s ease-in-out"},"",""),children:r})}))}},5954:function(e,n,r){r.r(n),r.d(n,{default:function(){return K}});var t=r(266),o=r(809),i=r.n(o),c=r(7566),u=r(7951),a=r(8031),l=r(9711),s=r(5641),d=r(7294),f=r(8424),p=r.n(f);var v=r(767),h=r(9929),b=r(9230),m=r(5458),y=function(e){var n;return function(){return n||(n=p().createClient(e)),n}}({mode:"rtc",codec:"vp8"}),O=function(e){var n=null;return function(){var r=(0,d.useState)(!1),t=r[0],o=r[1],i=(0,d.useState)(null),c=i[0],u=i[1],a=(0,d.useRef)(n);return(0,d.useEffect)((function(){return null===a.current?function(){try{return Promise.resolve(p().createMicrophoneAudioTrack(e)).then((function(e){return n=e}))}catch(r){return Promise.reject(r)}}().then((function(e){a.current=e,o(!0)}),(function(e){u(e)})):o(!0),function(){n=null}}),[]),{ready:t,track:a.current,error:c}}}({encoderConfig:{sampleRate:48e3,stereo:!0,bitrate:128}});var g=r(9353),w=r(917),k=r(9445),j=r(1371),Z=r(5944),T=function(e){var n=e.defaultValue,r=e.onChange,t=(0,d.useState)(null!==n&&void 0!==n&&n),o=t[0],i=t[1],c=o?"mic-off":"mic";return(0,d.useEffect)((function(){null===r||void 0===r||r(o)}),[o]),(0,Z.tZ)("button",{css:(0,w.iv)({backgroundColor:o?j.O.gray[4]:j.O.gray[2],borderRadius:"50%",border:"none",width:80,height:80,cursor:"pointer",transition:"background-color 0.2s ease-in-out"},"",""),onClick:function(){return i((function(e){return!e}))},children:(0,Z.tZ)(k.J,{name:c,type:"outline",size:40,color:j.O.white},c)})},C=r(2809),P=r(1164);var x=["color","size","fontSize","children","audioTrack"];function S(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function z(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?S(Object(r),!0).forEach((function(n){(0,C.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var E=function(e){var n=e.color,r=e.size,t=(e.fontSize,e.children),o=e.audioTrack,i=(0,P.Z)(e,x),c=(0,d.useState)(0),u=c[0],a=c[1],l=.3*u+1;return(0,d.useEffect)((function(){if(null!=o)return o.setAudioFrameCallback((function(e){var n=e.getChannelData(0);a(function(e){var n=e.reduce((function(e,n){return e+Math.abs(n)}),0);return Math.sqrt(n/e.length)}(n))})),function(){null===o||void 0===o||o.setAudioFrameCallback(null)}}),[o]),(0,Z.BX)(g.kC,z(z({direction:"column",justify:"center",align:"center",css:(0,w.iv)({backgroundColor:n,color:j.O.white,width:r,height:r,borderRadius:"50%",opacity:.6,transition:"background-color 0.5s ease-in"},"","")},i),{},{children:[t,(0,Z.tZ)("div",{style:{transform:"scale(".concat(l,")")},css:(0,w.iv)({width:r,height:r,transition:"transform 0.1s ease-in-out",filter:"blur(2px)",position:"absolute",zIndex:0,backgroundColor:n,opacity:.3,borderRadius:"50%"},"","")})]}))};var D={name:"1d3w5wq",styles:"width:100%"},A=function(e){var n=e.playing,r=e.me,t=e.myAudioTrack,o=e.remoteUser,i=e.remoteUserAudioTrack,c="JOINED"===e.remoteStatus,u=c&&null==i;return(0,Z.BX)(g.Kq,{justify:"center",align:"center",gutter:16,css:D,children:[(0,Z.tZ)(E,{color:n?j.O.primary:j.O.gray[6],size:150,audioTrack:t,children:(0,Z.tZ)(g.xv,{children:r.nickname})}),(0,Z.BX)(E,{color:c?j.O.cyan[5]:j.O.gray[6],size:150,audioTrack:i,children:[(0,Z.tZ)(g.xv,{children:c?o.nickname:""}),u&&(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)(g.Ki,{size:8}),(0,Z.tZ)(k.J,{name:"mic-off",size:20,color:j.O.red[5]})]})]})]})},I=r(1163),N=r(2132);var B={name:"a3z6ut",styles:"padding:0 20px"},X={name:"1d3w5wq",styles:"width:100%"},K=function(e){var n,r,o=e.interviewId,f=e.token,p=e.onReady,w=(0,h.E)().me,k=(0,m.z)(o).data,j=(null===k||void 0===k?void 0:k.interviewer.id)===(null===w||void 0===w?void 0:w.id),C=null!==(n=null===k||void 0===k?void 0:k.agora_channel_id)&&void 0!==n?n:"",P=function(e){var n=e.interviewId,r=e.channelName,o=e.token,c=y(),u=O(),a=u.track,f=u.ready,p=(0,s.zj)(),g=(0,l.Z)(p,3),w=g[0],k=g[1],j=g[2],Z=(0,d.useState)("WAITING"),T=Z[0],C=Z[1],P=(0,d.useState)(),x=P[0],S=P[1],z=(0,h.E)().me,E=(0,m.z)(n).data,D=(0,d.useMemo)((function(){return(null===E||void 0===E?void 0:E.interviewer.id)===(null===z||void 0===z?void 0:z.id)?null===E||void 0===E?void 0:E.interviewee:null===E||void 0===E?void 0:E.interviewer}),[E,z]),A=(0,d.useCallback)((0,t.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,b.hT)(n),e.next=3,c.join(v.xD,r,o,z.id);case 3:k(),null!=a&&c.publish(a);case 5:case"end":return e.stop()}}),e)}))),[a,k]),I=(0,d.useCallback)((0,t.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C("LEFT"),S(void 0),c.leave(),null===a||void 0===a||a.setMuted(!1),j(),(0,b.uC)(n);case 6:case"end":return e.stop()}}),e)}))),[c,j,a,n]);return(0,d.useEffect)((function(){if(!1!==f&&null!=a){var e=function(){var e=(0,t.Z)(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("\uc720\uc800\uac00 \ucc44\ub110\uc5d0 \uc785\uc7a5\ud558\uc600\uc2b5\ub2c8\ub2e4",n),C("JOINED");case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),n=function(){var e=(0,t.Z)(i().mark((function e(n,r){var t,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799\uc744 Publish \ud558\uc600\uc2b5\ub2c8\ub2e4",n),e.next=3,c.subscribe(n,r);case 3:null===(t=n.audioTrack)||void 0===t||t.setVolume(250),null===(o=n.audioTrack)||void 0===o||o.play(),S(n.audioTrack);case 6:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),r=function(){var e=(0,t.Z)(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799 Publish\ub97c \uc911\ub2e8\ud558\uc600\uc2b5\ub2c8\ub2e4",n),null===(r=n.audioTrack)||void 0===r||r.stop(),e.next=4,c.unsubscribe(n);case 4:S(n.audioTrack);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),o=function(e){console.log("\uc0c1\ub300\ubc29\uc774 \ud1b5\ud654\ub97c \uc885\ub8cc\ud558\uc600\uc2b5\ub2c8\ub2e4",e),I()};return c.on("user-joined",e),c.on("user-published",n),c.on("user-unpublished",r),c.on("user-left",o),a.setVolume(250),function(){"CONNECTED"!==c.connectionState&&"CONNECTING"!==c.connectionState||(c.off("user-joined",e),c.off("user-published",n),c.off("user-unpublished",r),c.off("user-left",o))}}}),[f,a]),{client:c,ready:f,localAudioTrack:a,isCalling:w,joinToChannel:A,leaveToChannel:I,remoteUser:D,remoteStatus:T,remoteAudioTrack:x}}({interviewId:o,channelName:C,token:f}),x=P.ready,S=P.localAudioTrack,z=P.isCalling,E=P.joinToChannel,D=P.leaveToChannel,K=P.remoteUser,M=P.remoteAudioTrack,V=P.remoteStatus;return(0,d.useEffect)((function(){!0===x&&(null===p||void 0===p||p())}),[x,p]),null==w||null==K?null:(0,Z.BX)(g.kC,{direction:"column",css:B,children:[(0,Z.tZ)(u.Z,{upper:(0,Z.BX)(u.Z.Text2,{children:["\ucc44\ub110\uba85 [",C,"]"]})}),(0,Z.tZ)(g.Ki,{size:40}),(0,Z.tZ)(A,{playing:z,me:w,myAudioTrack:null!==S&&void 0!==S?S:void 0,remoteUser:K,remoteUserAudioTrack:M,remoteStatus:V}),z?(0,Z.BX)(g.kC,{direction:"column",align:"center",justify:"center",css:X,children:[(0,Z.tZ)(g.Ki,{size:50}),(0,Z.tZ)(T,{defaultValue:null===S||void 0===S?void 0:S.muted,onChange:function(e){null===S||void 0===S||S.setMuted(e)}}),(0,Z.tZ)(g.Ki,{size:12}),(0,Z.tZ)("input",{type:"range",min:"0",max:"1000",defaultValue:1e3*(null!==(r=null===S||void 0===S?void 0:S.getVolumeLevel())&&void 0!==r?r:0),onChange:function(e){null===S||void 0===S||S.setVolume(Number(e.target.value))}})]}):null,(0,Z.tZ)(c.Z,{show:!0,children:z?(0,Z.tZ)(a.Z.BottomCTA,{styleType:"danger",onClick:(0,t.Z)(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:n=(0,N.f0)({interviewId:o}),I.default.push("/interviews/".concat(j?"feedback":"nps").concat(n));case 4:case"end":return e.stop()}}),e)}))),children:"\ub098\uac00\uae30"}):(0,Z.tZ)(a.Z.BottomCTA,{styleType:"primary",onClick:E,disabled:!1===x||null==S,children:"\uc785\uc7a5\ud558\uae30"})})]})}},1164:function(e,n,r){function t(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}r.d(n,{Z:function(){return t}})}}]);