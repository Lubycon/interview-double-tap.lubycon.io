"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{7951:function(e,t,n){var r=n(2809),i=n(917),o=n(1164),c=n(1371),u=n(9353),a=n(5944),l=["children"],s=["children"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=function(e){var t=e.upper,n=e.lower;return(0,a.BX)(u.kC,{direction:"column",children:[(0,a.tZ)(u.Ki,{size:24}),t,null!=t&&null!=n?(0,a.tZ)(u.Ki,{size:8}):null,n,(0,a.tZ)(u.Ki,{size:16})]})};v.Text2=function(e){var t=e.children,n=(0,o.Z)(e,l);return(0,a.tZ)("h2",f(f({css:(0,i.iv)({fontWeight:"bold",fontSize:24,lineHeight:1.3,color:c.O.gray[9],whiteSpace:"pre-line"},"","")},n),{},{children:t}))},v.Text6=function(e){var t=e.children,n=(0,o.Z)(e,s);return(0,a.tZ)("p",f(f({},n),{},{children:t}))},t.Z=v},7566:function(e,t,n){var r=n(2809),i=n(917),o=n(1164),c=n(6914),u=n(6557),a=n(5944),l=["show","children"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.show,n=e.children,r=(0,o.Z)(e,l);return(0,a.tZ)("div",d(d({css:(0,i.iv)({position:"fixed",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:c.t,zIndex:u.k.FIXED_BOTTOM,boxSizing:"border-box"},"","")},r),{},{children:(0,a.tZ)("div",{css:(0,i.iv)({transform:"translateY(".concat(t?"0":"100%",")"),transition:"transform 0.3s ease-in-out"},"",""),children:n})}))}},5954:function(e,t,n){n.r(t),n.d(t,{default:function(){return K}});var r=n(266),i=n(809),o=n.n(i),c=n(7566),u=n(7951),a=n(8031),l=n(9711),s=n(5641),d=n(7294),f=n(8424),v=n.n(f);var p=n(767),h=n(9929),b=n(9230),m=n(5458),y=function(e){var t;return function(){return t||(t=v().createClient(e)),t}}({mode:"rtc",codec:"vp8"}),O=function(e){var t=null;return function(){var n=(0,d.useState)(!1),r=n[0],i=n[1],o=(0,d.useState)(null),c=o[0],u=o[1],a=(0,d.useRef)(t);return(0,d.useEffect)((function(){return null===a.current?function(){try{return Promise.resolve(v().createMicrophoneAudioTrack(e)).then((function(e){return t=e}))}catch(n){return Promise.reject(n)}}().then((function(e){a.current=e,i(!0)}),(function(e){u(e)})):i(!0),function(){t=null}}),[]),{ready:r,track:a.current,error:c}}}({encoderConfig:"high_quality"});var g=n(9353),w=n(917),k=n(9445),Z=n(1371),j=n(5944),C=function(e){var t=e.defaultValue,n=e.onChange,r=(0,d.useState)(null!==t&&void 0!==t&&t),i=r[0],o=r[1],c=i?"mic-off":"mic";return(0,d.useEffect)((function(){null===n||void 0===n||n(i)}),[i]),(0,j.tZ)("button",{css:(0,w.iv)({backgroundColor:i?Z.O.gray[4]:Z.O.gray[2],borderRadius:"50%",border:"none",width:80,height:80,cursor:"pointer",transition:"background-color 0.2s ease-in-out"},"",""),onClick:function(){return o((function(e){return!e}))},children:(0,j.tZ)(k.J,{name:c,type:"outline",size:40,color:Z.O.white},c)})},T=n(2809),x=n(1164);var P=["color","size","fontSize","children","audioTrack"];function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,T.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=function(e){var t=e.color,n=e.size,r=(e.fontSize,e.children),i=e.audioTrack,o=(0,x.Z)(e,P),c=(0,d.useState)(0),u=c[0],a=c[1],l=.3*u+1;return(0,d.useEffect)((function(){if(null!=i)return i.setAudioFrameCallback((function(e){var t=e.getChannelData(0);a(function(e){var t=e.reduce((function(e,t){return e+Math.abs(t)}),0);return Math.sqrt(t/e.length)}(t))})),function(){null===i||void 0===i||i.setAudioFrameCallback(null)}}),[i]),(0,j.BX)(g.kC,z(z({direction:"column",justify:"center",align:"center",css:(0,w.iv)({backgroundColor:t,color:Z.O.white,width:n,height:n,borderRadius:"50%",opacity:.6,transition:"background-color 0.5s ease-in"},"","")},o),{},{children:[r,(0,j.tZ)("div",{style:{transform:"scale(".concat(l,")")},css:(0,w.iv)({width:n,height:n,transition:"transform 0.1s ease-in-out",filter:"blur(2px)",position:"absolute",zIndex:0,backgroundColor:t,opacity:.3,borderRadius:"50%"},"","")})]}))};var D={name:"1d3w5wq",styles:"width:100%"},N=function(e){var t=e.playing,n=e.me,r=e.myAudioTrack,i=e.remoteUser,o=e.remoteUserAudioTrack,c="JOINED"===e.remoteStatus,u=c&&null==o;return(0,j.BX)(g.Kq,{justify:"center",align:"center",gutter:16,css:D,children:[(0,j.tZ)(E,{color:t?Z.O.primary:Z.O.gray[6],size:150,audioTrack:r,children:(0,j.tZ)(g.xv,{children:n.nickname})}),(0,j.BX)(E,{color:c?Z.O.cyan[5]:Z.O.gray[6],size:150,audioTrack:o,children:[(0,j.tZ)(g.xv,{children:c?i.nickname:""}),u&&(0,j.BX)(j.HY,{children:[(0,j.tZ)(g.Ki,{size:8}),(0,j.tZ)(k.J,{name:"mic-off",size:20,color:Z.O.red[5]})]})]})]})},A=n(1163),B=n(2132);var I={name:"a3z6ut",styles:"padding:0 20px"},X={name:"1d3w5wq",styles:"width:100%"},K=function(e){var t,n=e.interviewId,i=e.token,f=e.onReady,v=(0,h.E)().me,w=(0,m.z)(n).data,k=(null===w||void 0===w?void 0:w.interviewer.id)===(null===v||void 0===v?void 0:v.id),Z=null!==(t=null===w||void 0===w?void 0:w.agora_channel_id)&&void 0!==t?t:"",T=function(e){var t=e.interviewId,n=e.channelName,i=e.token,c=y(),u=O(),a=u.track,f=u.ready,v=(0,s.zj)(),g=(0,l.Z)(v,3),w=g[0],k=g[1],Z=g[2],j=(0,d.useState)("WAITING"),C=j[0],T=j[1],x=(0,d.useState)(),P=x[0],S=x[1],z=(0,h.E)().me,E=(0,m.z)(t).data,D=(0,d.useMemo)((function(){return(null===E||void 0===E?void 0:E.interviewer.id)===(null===z||void 0===z?void 0:z.id)?null===E||void 0===E?void 0:E.interviewee:null===E||void 0===E?void 0:E.interviewer}),[E,z]),N=(0,d.useCallback)((0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,b.hT)(t),e.next=3,c.join(p.xD,n,i,z.id);case 3:k(),null!=a&&c.publish(a);case 5:case"end":return e.stop()}}),e)}))),[a,k]),A=(0,d.useCallback)((0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T("LEFT"),S(void 0),c.leave(),null===a||void 0===a||a.setMuted(!1),Z(),(0,b.uC)(t);case 6:case"end":return e.stop()}}),e)}))),[c,Z,a,t]);return(0,d.useEffect)((function(){if(!1!==f&&null!=a){var e=function(){var e=(0,r.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("\uc720\uc800\uac00 \ucc44\ub110\uc5d0 \uc785\uc7a5\ud558\uc600\uc2b5\ub2c8\ub2e4",t),T("JOINED");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799\uc744 Publish \ud558\uc600\uc2b5\ub2c8\ub2e4",t),e.next=3,c.subscribe(t,n);case 3:null===(r=t.audioTrack)||void 0===r||r.setVolume(250),null===(i=t.audioTrack)||void 0===i||i.play(),S(t.audioTrack);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n=function(){var e=(0,r.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799 Publish\ub97c \uc911\ub2e8\ud558\uc600\uc2b5\ub2c8\ub2e4",t),null===(n=t.audioTrack)||void 0===n||n.stop(),e.next=4,c.unsubscribe(t);case 4:S(t.audioTrack);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=function(e){console.log("\uc0c1\ub300\ubc29\uc774 \ud1b5\ud654\ub97c \uc885\ub8cc\ud558\uc600\uc2b5\ub2c8\ub2e4",e),A()};return c.on("user-joined",e),c.on("user-published",t),c.on("user-unpublished",n),c.on("user-left",i),function(){"CONNECTED"!==c.connectionState&&"CONNECTING"!==c.connectionState||(c.off("user-joined",e),c.off("user-published",t),c.off("user-unpublished",n),c.off("user-left",i))}}}),[f,a]),{client:c,ready:f,localAudioTrack:a,isCalling:w,joinToChannel:N,leaveToChannel:A,remoteUser:D,remoteStatus:C,remoteAudioTrack:P}}({interviewId:n,channelName:Z,token:i}),x=T.ready,P=T.localAudioTrack,S=T.isCalling,z=T.joinToChannel,E=T.leaveToChannel,D=T.remoteUser,K=T.remoteAudioTrack,_=T.remoteStatus,q=(0,d.useState)(100),M=q[0],V=q[1],U=(0,d.useState)(100),R=U[0],F=U[1];return(0,d.useEffect)((function(){!0===x&&(null===f||void 0===f||f())}),[x,f]),null==v||null==D?null:(0,j.BX)(g.kC,{direction:"column",css:I,children:[(0,j.tZ)(u.Z,{upper:(0,j.BX)(u.Z.Text2,{children:["\ucc44\ub110\uba85 [",Z,"]"]})}),(0,j.tZ)(g.Ki,{size:40}),(0,j.tZ)(N,{playing:S,me:v,myAudioTrack:null!==P&&void 0!==P?P:void 0,remoteUser:D,remoteUserAudioTrack:K,remoteStatus:_}),S?(0,j.BX)(g.kC,{direction:"column",align:"center",justify:"center",css:X,children:[(0,j.tZ)(g.Ki,{size:50}),(0,j.tZ)(C,{defaultValue:null===P||void 0===P?void 0:P.muted,onChange:function(e){null===P||void 0===P||P.setMuted(e)}}),(0,j.tZ)(g.Ki,{size:24}),(0,j.BX)(g.Kq,{gutter:12,children:[(0,j.tZ)(g.xv,{children:"\ub9c8\uc774\ud06c \ubcfc\ub968"}),(0,j.tZ)("input",{type:"range",min:"0",max:"1000",defaultValue:M,onChange:function(e){null===P||void 0===P||P.setVolume(Number(e.target.value)),V(Number(e.target.value))}}),(0,j.tZ)(g.xv,{size:12,children:M})]}),(0,j.BX)(g.Kq,{gutter:12,children:[(0,j.tZ)(g.xv,{children:"\uc0c1\ub300\ubc29 \ub9c8\uc774\ud06c \ubcfc\ub968"}),(0,j.tZ)("input",{type:"range",min:"0",max:"1000",defaultValue:R,onChange:function(e){null===K||void 0===K||K.setVolume(Number(e.target.value)),F(Number(e.target.value))}}),(0,j.tZ)(g.xv,{size:12,children:R})]})]}):null,(0,j.tZ)(c.Z,{show:!0,children:S?(0,j.tZ)(a.Z.BottomCTA,{styleType:"danger",onClick:(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:t=(0,B.f0)({interviewId:n}),A.default.push("/interviews/".concat(k?"feedback":"nps").concat(t));case 4:case"end":return e.stop()}}),e)}))),children:"\ub098\uac00\uae30"}):(0,j.tZ)(a.Z.BottomCTA,{styleType:"primary",onClick:z,disabled:!1===x||null==P,children:"\uc785\uc7a5\ud558\uae30"})})]})}},1164:function(e,t,n){function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{Z:function(){return r}})}}]);