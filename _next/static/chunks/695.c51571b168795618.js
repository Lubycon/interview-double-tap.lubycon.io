"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[695],{7566:function(e,n,t){var r=t(2809),i=t(917),o=t(1164),u=t(6914),c=t(6557),a=t(5944),l=["show","children"];function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=e.show,t=e.children,r=(0,o.Z)(e,l);return(0,a.tZ)("div",d(d({css:(0,i.iv)({position:"fixed",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:u.t,zIndex:c.k.FIXED_BOTTOM,boxSizing:"border-box"},"","")},r),{},{children:(0,a.tZ)("div",{css:(0,i.iv)({transform:"translateY(".concat(n?"0":"100%",")"),transition:"transform 0.3s ease-in-out"},"",""),children:t})}))}},4143:function(e,n,t){t.d(n,{P:function(){return r},Y:function(){return i}});var r=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],i={SUNDAY:"\uc77c\uc694\uc77c",MONDAY:"\uc6d4\uc694\uc77c",TUESDAY:"\ud654\uc694\uc77c",WEDNESDAY:"\uc218\uc694\uc77c",THURSDAY:"\ubaa9\uc694\uc77c",FRIDAY:"\uae08\uc694\uc77c",SATURDAY:"\ud1a0\uc694\uc77c"}},9695:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var r=t(266),i=t(809),o=t.n(i),u=t(7566),c=t(8031),a=t(9711),l=t(5641),s=t(7294),d=t(8424),f=t.n(d);var v=t(767),h=t(9929),m=t(9230),p=t(5458),b=function(e){var n;return function(){return n||(n=f().createClient(e)),n}}({mode:"rtc",codec:"vp8"}),w=function(e){var n=null;return function(){var t=(0,s.useState)(!1),r=t[0],i=t[1],o=(0,s.useState)(null),u=o[0],c=o[1],a=(0,s.useRef)(n);return(0,s.useEffect)((function(){return null===a.current?function(){try{return Promise.resolve(f().createMicrophoneAudioTrack(e)).then((function(e){return n=e}))}catch(t){return Promise.reject(t)}}().then((function(e){a.current=e,i(!0)}),(function(e){c(e)})):i(!0),function(){n=null}}),[]),{ready:r,track:a.current,error:u}}}({encoderConfig:"high_quality"});var y=t(9353),g=t(917),k=t(9445),O=t(1371),Z=t(5944),T=function(e){var n=e.defaultValue,t=e.onChange,r=(0,s.useState)(null!==n&&void 0!==n&&n),i=r[0],o=r[1],u=i?"mic-off":"mic";return(0,s.useEffect)((function(){null===t||void 0===t||t(i)}),[i]),(0,Z.tZ)("button",{css:(0,g.iv)({backgroundColor:i?O.O.gray[4]:O.O.gray[2],borderRadius:"50%",border:"none",width:50,height:50,cursor:"pointer",transition:"background-color 0.2s ease-in-out"},"",""),onClick:function(){return o((function(e){return!e}))},children:(0,Z.tZ)(k.J,{name:u,type:"outline",size:30,color:O.O.white},u)})},D=t(2809),C=t(1164);var j=["userName","color","size","fontSize","children","audioTrack"];function A(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function S(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?A(Object(t),!0).forEach((function(n){(0,D.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var E=function(e){var n=e.userName,t=e.color,r=e.size,i=(e.fontSize,e.children),o=e.audioTrack,u=(0,C.Z)(e,j),c=(0,s.useState)(0),a=c[0],l=c[1],d=.3*a+1;return(0,s.useEffect)((function(){if(null!=o)return o.setAudioFrameCallback((function(e){var n=e.getChannelData(0);l(2*function(e){var n=e.reduce((function(e,n){return e+Math.abs(n)}),0);return Math.sqrt(n/e.length)}(n))})),function(){try{null===o||void 0===o||o.setAudioFrameCallback(null)}catch(e){e instanceof Error&&console.warn(e.message)}}}),[o]),(0,Z.BX)(y.Kq,{gutter:16,direction:"column",align:"center",children:[(0,Z.tZ)(y.kC,S(S({direction:"column",justify:"center",align:"center",css:(0,g.iv)({backgroundColor:t,color:O.O.white,width:r,height:r,borderRadius:"50%",opacity:.6,transition:"background-color 0.5s ease-in"},"","")},u),{},{children:(0,Z.tZ)("div",{style:{transform:"scale(".concat(d,")")},css:(0,g.iv)({width:r,height:r,transition:"transform 0.1s ease-in-out",filter:"blur(2px)",position:"absolute",zIndex:0,backgroundColor:t,opacity:.3,borderRadius:"50%"},"","")})})),(0,Z.tZ)(y.xv,{size:14,weight:"bold",align:"center",css:(0,g.iv)({width:r+24,wordBreak:"break-all"},"",""),children:n}),i]})};var z={name:"1d3w5wq",styles:"width:100%"},N=function(e){var n=e.playing,t=e.me,r=e.myAudioTrack,i=e.remoteUser,o=e.remoteUserAudioTrack,u="JOINED"===e.remoteStatus,c=u&&null==o;return(0,Z.BX)(y.Kq,{justify:"center",gutter:32,css:z,children:[(0,Z.tZ)(E,{userName:t.nickname,color:n?O.O.primary:O.O.gray[3],size:100,audioTrack:r}),(0,Z.tZ)(E,{userName:i.nickname,color:u?O.O.cyan[5]:O.O.gray[3],size:100,audioTrack:o,children:c&&(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)(y.Ki,{size:8}),(0,Z.tZ)(k.J,{name:"mic-off",size:20,color:O.O.red[5]})]})})]})},x=t(1163),P=t(2132),Y=t(8996),I=t(9184),M=t(9013),U=t(3882);var B=t(3946),_=t(1820);function R(e,n){(0,U.Z)(2,arguments);var t=(0,B.Z)(n);return(0,_.Z)(e,6e4*t)}var X=function(e){return function(e,n){(0,U.Z)(2,arguments);var t=(0,B.Z)(n);return R(e,-t)}(e,10)};function H(e){var n=(0,p.z)(e).data,t=(0,s.useState)(!1),r=t[0],i=t[1];return(0,l.Yz)((function(){if(null!=n){var e=function(e,n){(0,U.Z)(2,arguments);var t=(0,M.Z)(e),r=(0,M.Z)(n);return t.getTime()>r.getTime()}(new Date,X(new Date(n.start_datetime)));i(e&&"DONE"!==n.status)}}),1e3),r}var q={name:"a3z6ut",styles:"padding:0 20px"},F={name:"1d3w5wq",styles:"width:100%"},K={name:"1d3w5wq",styles:"width:100%"},W=function(e,n){var t;switch(n){case"WAITING":return"\uc778\ud130\ubdf0\uac00 \uc544\uc9c1 \uc2dc\uc791\ub418\uc9c0 \uc54a\uc558\uc5b4\uc694";case"DONE":return"\uc778\ud130\ubdf0\uac00 \uc885\ub8cc\ub418\uc5c8\uc5b4\uc694";default:return"".concat(null!==(t=null===e||void 0===e?void 0:e.nickname)&&void 0!==t?t:"OOO","\ub2d8\uacfc\uc758 \uc778\ud130\ubdf0")}},J=function(e){var n,t=e.interviewId,i=e.token,d=e.onReady,f=(0,h.E)().me,g=(0,p.z)(t).data,k=H(t),D=function(e){var n=(0,p.z)(e).data,t=(0,s.useState)(0),r=t[0],i=t[1];return(0,l.Yz)((function(){if(null!=n){var e=new Date,t=new Date(n.end_datetime);i((t.getTime()-e.getTime())/1e3)}}),500),Math.floor(r)}(t),C=(null===g||void 0===g?void 0:g.interviewer.id)===(null===f||void 0===f?void 0:f.id),j=C?null===g||void 0===g?void 0:g.interviewee:null===g||void 0===g?void 0:g.interviewer,A=null!==(n=null===g||void 0===g?void 0:g.agora_channel_id)&&void 0!==n?n:"",S=function(e){var n=e.interviewId,t=e.channelName,i=e.token,u=b(),c=w(),d=c.track,f=c.ready,y=(0,l.zj)(),g=(0,a.Z)(y,3),k=g[0],O=g[1],Z=g[2],T=(0,s.useState)("WAITING"),D=T[0],C=T[1],j=(0,s.useState)(),A=j[0],S=j[1],E=(0,h.E)().me,z=(0,p.z)(n).data,N=(0,s.useMemo)((function(){return(null===z||void 0===z?void 0:z.interviewer.id)===(null===E||void 0===E?void 0:E.id)?null===z||void 0===z?void 0:z.interviewee:null===z||void 0===z?void 0:z.interviewer}),[z,E]),x=(0,s.useCallback)((0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,m.hT)(n),e.next=3,u.join(v.xD,t,i,E.id);case 3:O(),null!=d&&u.publish(d);case 5:case"end":return e.stop()}}),e)}))),[d,O]),P=(0,s.useCallback)((0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C("LEFT"),S(void 0),u.leave(),null===d||void 0===d||d.setMuted(!1),Z(),(0,m.uC)(n);case 6:case"end":return e.stop()}}),e)}))),[u,Z,d,n]);return(0,s.useEffect)((function(){if(!1!==f&&null!=d){var e=function(){var e=(0,r.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("\uc720\uc800\uac00 \ucc44\ub110\uc5d0 \uc785\uc7a5\ud558\uc600\uc2b5\ub2c8\ub2e4",n),C("JOINED");case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),n=function(){var e=(0,r.Z)(o().mark((function e(n,t){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799\uc744 Publish \ud558\uc600\uc2b5\ub2c8\ub2e4",n),e.next=3,u.subscribe(n,t);case 3:null===(r=n.audioTrack)||void 0===r||r.setVolume(250),null===(i=n.audioTrack)||void 0===i||i.play(),S(n.audioTrack);case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),t=function(){var e=(0,r.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\uc0c1\ub300\ubc29\uc774 \uc624\ub514\uc624 \ud2b8\ub799 Publish\ub97c \uc911\ub2e8\ud558\uc600\uc2b5\ub2c8\ub2e4",n),null===(t=n.audioTrack)||void 0===t||t.stop(),e.next=4,u.unsubscribe(n);case 4:S(n.audioTrack);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i=function(e){console.log("\uc0c1\ub300\ubc29\uc774 \ud1b5\ud654\ub97c \uc885\ub8cc\ud558\uc600\uc2b5\ub2c8\ub2e4",e),P()};return u.on("user-joined",e),u.on("user-published",n),u.on("user-unpublished",t),u.on("user-left",i),function(){"CONNECTED"!==u.connectionState&&"CONNECTING"!==u.connectionState||(u.off("user-joined",e),u.off("user-published",n),u.off("user-unpublished",t),u.off("user-left",i))}}}),[f,d]),{client:u,ready:f,localAudioTrack:d,isCalling:k,joinToChannel:x,leaveToChannel:P,remoteUser:N,remoteStatus:D,remoteAudioTrack:A}}({interviewId:t,channelName:A,token:i}),E=S.ready,z=S.localAudioTrack,M=S.isCalling,U=S.joinToChannel,B=S.leaveToChannel,_=S.remoteUser,R=S.remoteAudioTrack,X=S.remoteStatus,J=!0===M,G=(0,s.useCallback)((0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:n=(0,P.f0)({interviewId:t}),x.default.replace("/interviews/".concat(C?"feedback":"nps").concat(n));case 4:case"end":return e.stop()}}),e)}))),[B,t,C]);return(0,s.useEffect)((function(){!0===E&&(null===d||void 0===d||d())}),[E,d]),(0,s.useEffect)((function(){D<0&&!0===M&&G()}),[D,M,G]),null==f||null==_||null==g?null:(0,Z.BX)(y.kC,{direction:"column",css:q,children:[(0,Z.BX)(y.Kq,{gutter:16,direction:"column",align:"center",css:F,children:[(0,Z.tZ)(y.Ki,{size:18}),(0,Z.tZ)(y.xv,{size:20,weight:"bold",align:"center",children:W(j,g.status)}),J?(0,Z.BX)(y.xv,{children:["\ub0a8\uc740 \uc2dc\uac04: ",(0,I.mr)(Math.floor(D/60)),":",(0,I.mr)(Math.floor(D%60))]}):(0,Z.BX)(y.xv,{color:O.O.gray[5],size:14,children:["\uc778\ud130\ubdf0 \uc2dc\uac04 : ",(0,Y.Z)(new Date(g.start_datetime),"M\uc6d4 d\uc77c HH\uc2dc mm\ubd84")," ~"," ",(0,Y.Z)(new Date(g.end_datetime),"M\uc6d4 d\uc77c HH\uc2dc mm\ubd84")]})]}),(0,Z.tZ)(y.Ki,{size:40}),(0,Z.tZ)(N,{playing:M,me:f,myAudioTrack:null!==z&&void 0!==z?z:void 0,remoteUser:_,remoteUserAudioTrack:R,remoteStatus:X}),M?(0,Z.BX)(y.kC,{direction:"column",align:"center",justify:"center",css:K,children:[(0,Z.tZ)(y.Ki,{size:50}),(0,Z.tZ)(T,{defaultValue:null===z||void 0===z?void 0:z.muted,onChange:function(e){null===z||void 0===z||z.setMuted(e)}})]}):null,k&&(0,Z.tZ)(u.Z,{show:!0,children:M?(0,Z.tZ)(c.Z.BottomCTA,{onClick:G,children:"\ub098\uac00\uae30"}):(0,Z.tZ)(c.Z.BottomCTA,{styleType:"primary",onClick:U,disabled:!1===E||null==z,children:"\uc785\uc7a5\ud558\uae30"})})]})}},9184:function(e,n,t){t.d(n,{x5:function(){return o},FO:function(){return u},mr:function(){return c}});var r=t(8996),i=t(4143),o=function(e){return(0,r.Z)(e,"yyyy-MM-dd'T'HH:mm")},u=function(e){return i.P[e.getDay()]},c=function(e){return e<0?"00":e>9?"".concat(e):"0".concat(e)}}}]);